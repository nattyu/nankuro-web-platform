version: 1.0
runtime: python311

build:
  commands:
    build:
      - python3 -m pip install --upgrade pip
      - python3 -m pip install -r requirements.txt -t /app/vendor

run:
  env:
    - name: PYTHONPATH
      value: /app/vendor

    # 追加（これだけでOK）
    - name: S3_BUCKET
      value: nankuro-uploads-prod   # ←ここはあなたの実バケット名
    - name: AWS_REGION
      value: ap-northeast-1
    - name: S3_PREFIX
      value: uploads/

  command: python3 -m hypercorn lambda_app.web_app:app --bind 0.0.0.0:8080 --log-level debug --access-logfile - --error-logfile -
  network:
    port: 8080
